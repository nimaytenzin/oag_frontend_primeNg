<div class="flex align-items-center justify-content-between">
    Tenants
    <p-button icon="pi pi-plus" (click)="openAddTenantsModal()"></p-button>
</div>

<i class="pi pi-pi-phone" style="font-size: 1rem"></i>
<p-table
    [value]="paginatedTenants.data"
    class="p-datatable-sm"
    [tableStyle]="{ 'min-width': '50rem' }"
>
    <ng-template pTemplate="header">
        <tr>
            <th>Details</th>
            <th>Address</th>
            <th>Bank Details</th>
            <th>Leases</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-tenant>
        <tr>
            <td>
                <p>
                    {{ tenant.firstName }}
                    <span *ngIf="tenant.middleName">
                        {{ tenant.middleName }}
                    </span>
                    <span *ngIf="tenant.lastName">
                        {{ tenant.lastName }}
                    </span>
                </p>
                <p class="flex align-items-center gap-2">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                        style="height: 1rem"
                    >
                        <path
                            d="M8 16.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"
                        />
                        <path
                            fill-rule="evenodd"
                            d="M4 4a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V4Zm4-1.5v.75c0 .414.336.75.75.75h2.5a.75.75 0 0 0 .75-.75V2.5h1A1.5 1.5 0 0 1 14.5 4v12a1.5 1.5 0 0 1-1.5 1.5H7A1.5 1.5 0 0 1 5.5 16V4A1.5 1.5 0 0 1 7 2.5h1Z"
                            clip-rule="evenodd"
                        />
                    </svg>

                    {{ tenant.phoneNumber }}
                </p>
                <p class="flex align-items-center gap-2">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                        style="height: 1rem"
                    >
                        <path
                            fill-rule="evenodd"
                            d="M5.404 14.596A6.5 6.5 0 1 1 16.5 10a1.25 1.25 0 0 1-2.5 0 4 4 0 1 0-.571 2.06A2.75 2.75 0 0 0 18 10a8 8 0 1 0-2.343 5.657.75.75 0 0 0-1.06-1.06 6.5 6.5 0 0 1-9.193 0ZM10 7.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Z"
                            clip-rule="evenodd"
                        />
                    </svg>
                    {{ tenant.email }}
                </p>
            </td>

            <td>
                Permanent Address
                <p>
                    {{ tenant.subadministrativeZone.name }}
                    / {{ tenant.subadministrativeZone.nameDzo }}
                </p>
                <p>
                    {{ tenant.administrativeZone.name }} /
                    {{ tenant.subadministrativeZone.nameDzo }}
                </p>
                <p>
                    {{ tenant.dzongkhag.name }} Dzongkhag /
                    {{ tenant.dzongkhag.nameDzo }}
                </p>
            </td>

            <td>
                <p>Bank name: {{ tenant.bankName }}</p>
                <p>Account Number: {{ tenant.accountNumber }}</p>
            </td>

            <td>
                <div class="gap-3 flex flex-wrap">
                    <div
                        *ngFor="let item of tenant.leaseAgreements"
                        class="flex flex-column gap-2 align-items-end hover:surface-50 cursor-pointer p-1"
                    >
                        <div
                            class="flex w-full align justify-content-between border-bottom-1 border-200"
                        >
                            <div class="flex align-items-end">
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    style="height: 25px; color: #3b82f6"
                                >
                                    <path
                                        d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z"
                                    />
                                    <path
                                        d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"
                                    />
                                </svg>
                                <p>lease Agreement</p>
                            </div>
                        </div>
                        <div>
                            <p>Unit: {{ item.unitId }}</p>
                            <p>Building: {{ item.buildingId }}</p>
                            <p>Use: {{ item.use }}</p>

                            <p>
                                Valid till:
                                {{ getMonthYearString(item.leaseEndDate) }}
                            </p>
                            <p
                                class="mt-2 pt-1 flex align-items-end border-200 justify-content-between border-top-1"
                            >
                                status
                                <p-tag
                                    [value]="item.leaseStatus"
                                    [severity]="getSeverity(item.leaseStatus)"
                                ></p-tag>
                            </p>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
    </ng-template>

    <ng-template pTemplate="summary">
        <div>
            <p-paginator
                (onPageChange)="onPageChange($event)"
                [first]="paginatedTenants.firstPage"
                [rows]="paginatedTenants.limit"
                [totalRecords]="paginatedTenants.count"
                [rowsPerPageOptions]="[10, 20, 50]"
            ></p-paginator>
        </div>
    </ng-template>
</p-table>
